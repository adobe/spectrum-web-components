import {
    Meta,
    Title,
    Primary,
    Controls,
    Stories,
    ArgTypes,
    Description,
    Subtitle,
    useOf,
} from '@storybook/addon-docs/blocks';
import {
    GettingStarted,
    SpectrumDocs,
    SpectrumStories,
    OverviewStory,
} from './blocks';

export const checkIsSingleStory = () => {
    const resolvedOf = useOf('meta', ['meta']);
    const { stories } = resolvedOf.csfFile;
    const visibleStories = Object.values(stories).filter(
        (story) =>
            story.tags?.includes('autodocs') || story.tags?.includes('dev')
    );
    return visibleStories.length === 1;
};

export const SingleStoryDescription = () => {
    const isSingleStory = checkIsSingleStory();

    return (isSingleStory ? <Description of="story" /> : null)

}

export const AdvancedExamplesStories = () => {
    const isSingleStory = checkIsSingleStory();

    return (isSingleStory ? null : <Stories includePrimary={false} />)

}

<Meta isTemplate />

<Title />
<Subtitle />
<Description />
<SingleStoryDescription />
<OverviewStory />
<GettingStarted />
<SpectrumDocs tag="usage" />

## API

<Primary />
<Controls />
<AdvancedExamplesStories />

## Feedback

Have feedback or questions? [Open an issue](https://github.com/adobe/spectrum-web-components/issues/new/choose).
