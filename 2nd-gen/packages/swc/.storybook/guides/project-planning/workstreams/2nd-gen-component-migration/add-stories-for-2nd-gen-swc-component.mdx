import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Project planning/Workstreams/2nd-gen component migration/Add stories for 2nd-gen component" />

# Add stories for 2nd-gen component

This guide walks you through creating Storybook stories for a 2nd-gen component. For detailed formatting rules and examples, see the [stories-format rules](/.cursor/rules/stories-format.mdc).

## Overview

Each component needs two files in its `stories/` folder:

| File                     | Purpose                                             |
| ------------------------ | --------------------------------------------------- |
| `[component].stories.ts` | Story definitions with examples and documentation   |
| `[component].usage.mdx`  | Documentation page that displays stories by section |

---

## Part 1: Create the stories file

Create `stories/[component].stories.ts` with the following sections, separated by visual dividers.

### Step 1: Add copyright header and imports

```typescript
/**
 * Copyright 2025 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * ...
 */

import { html } from 'lit';
import type { Meta, StoryObj as Story } from '@storybook/web-components';
import { getStorybookHelpers } from '@wc-toolkit/storybook-helpers';

import { ComponentName } from '@adobe/swc/component-name';
import '@adobe/swc/component-name';
```

### Step 2: Add the METADATA section

Set up Storybook helpers and configure the meta object.

```typescript
// ────────────────
//    METADATA
// ────────────────

const { events, args, argTypes, template } =
    getStorybookHelpers('swc-component-name');

/**
 * Component description explaining its purpose and key features.
 * This JSDoc becomes the component overview in the docs.
 */
const meta: Meta = {
    title: 'Component name',
    component: 'swc-component-name',
    args,
    argTypes,
    render: (args) => template(args),
    parameters: {
        actions: { handles: events },
        docs: {
            subtitle: 'Brief component description',
            design: {
                type: 'figma',
                url: 'https://www.figma.com/design/1234567890/Component-Name',
            },
            stackblitz: {
                url: 'https://stackblitz.com/edit/swc-component-name',
            },
        },
        flexLayout: 'row-wrap',
    },
    tags: ['migrated'],
};

export default meta;
```

**Required meta fields:**

- `title` - Component name as it appears in Storybook sidebar
- `component` - The custom element tag name
- `args`, `argTypes` - From `getStorybookHelpers()`
- `render` - Template function from `getStorybookHelpers()`
- `parameters.docs.subtitle` - Brief description shown in docs header

**Optional meta fields:**

- `parameters.docs.design` - Design documentation for the component. Only add if the component has design documentation.
- `parameters.docs.stackblitz` - Stackblitz URL for the component. Only add if the component has a Stackblitz example.
- `parameters.actions.handles` - Event handlers to bind to the component. Only add if the component has event handlers defined in the component's API.
- `parameters.flexLayout` - Default flex layout to use for the component's stories. Only add if the component has multiple items or elements that need to be aligned.
- `tags: ['migrated']` - Indicates refined format. Only add if the component has been migrated to the 2nd-gen format.

### Step 3: Add the Playground story

The Playground is the interactive demo at the top of the docs page. **Do not add a JSDoc comment.**

```typescript
// ────────────────────
//    AUTODOCS STORY
// ────────────────────

export const Playground: Story = {
    args: {
        // Set to the most common use case
        size: 'm',
        'default-slot': 'Example content',
    },
    tags: ['autodocs', 'dev'],
};
```

### Step 4: Add Anatomy story (if applicable)

Document all slots and content-rendering properties. Combine all variations into one story.

```typescript
// ──────────────────────────
//    ANATOMY STORIES
// ──────────────────────────

/**
 * ### Visual structure
 *
 * A badge consists of:
 *
 * 1. **Container** - Colored background with rounded corners
 * 2. **Label** - Text content describing the status or category (required)
 * 3. **Icon** (optional) - Visual indicator positioned before the label
 *
 * ### Technical structure
 *
 * #### Slots
 *
 * - **Default slot**: Text label displayed in the badge (required for accessibility)
 * - **icon slot**: Optional icon element positioned to the left of the label
 *
 * #### Properties
 *
 * - **Variant**: Color scheme ([semantic](#semantic-variants) or [non-semantic](#non-semantic-variants) variants)
 * - [**Size**](#sizes): Visual size
 * - [**Subtle**](#subtle): Boolean for reduced visual prominence
 * - [**Outline**](#outline): Boolean for bordered style (semantic variants only)
 * - [**Fixed**](#fixed): Border radius adjustment for edge positioning
 */
export const Anatomy: Story = {
    render: (args) => html`
        ${template({ ...args, 'default-slot': 'Text only' })}
        ${template({ ...args, 'icon-slot': '✓' })}
        ${template({ ...args, 'default-slot': 'Both', 'icon-slot': '✓' })}
    `,
    tags: ['anatomy'],
};
```

### Step 5: Add Options stories

Document every attribute/property not covered in Anatomy, States, or Behaviors. Use `section-order` to control display order.

**Common options stories (in order):**

| Order | Story                   | What to show                                     |
| ----- | ----------------------- | ------------------------------------------------ |
| 0     | `Sizes`                 | All size variants (s, m, l, xl)                  |
| 1     | `SemanticVariants`      | positive, informative, negative, notice, neutral |
| 2     | `NonSemanticVariants`   | Color-coded categories (seafoam, indigo, etc.)   |
| 3     | `Outline`               | Outline style variants                           |
| 4     | `Subtle`                | Subtle/quiet variants                            |
| 5     | `Fixed` / `Positioning` | Position modifiers                               |
| 10    | `StaticColors`          | Static color pattern (if applicable)             |

```typescript
// ──────────────────────────
//    OPTIONS STORIES
// ──────────────────────────

/**
 * Components come in multiple sizes to fit various contexts.
 */
export const Sizes: Story = {
    render: () => html`
        <swc-component size="s">Small</swc-component>
        <swc-component size="m">Medium</swc-component>
        <swc-component size="l">Large</swc-component>
    `,
    parameters: { flexLayout: true, 'section-order': 0 },
    tags: ['options'],
};

/**
 * Semantic variants provide meaning through color:
 * - **Positive**: approved, complete, success
 * - **Informative**: active, in use, live
 * - **Negative**: error, alert, rejected
 * - **Notice**: pending, scheduled
 * - **Neutral**: archived, paused, draft
 */
export const SemanticVariants: Story = {
    render: () => html`
        <swc-component variant="positive">Approved</swc-component>
        <swc-component variant="informative">Active</swc-component>
        <swc-component variant="negative">Error</swc-component>
    `,
    parameters: { flexLayout: true, 'section-order': 1 },
    tags: ['options'],
};
```

**Static color pattern** (if component supports `static-color`):

Create a single story for the static color pattern:

```typescript
export const StaticColors: Story = {
    render: (args) => html`
        ${component.STATIC_COLORS.map(
            (color) => html`${template({ ...args, 'static-color': color })}`
        )}
    `,
    parameters: {
        staticColorsDemo: true,
        'section-order': 2,
    },
    tags: ['options'],
};
```

### Step 6: Add States stories (if applicable)

Combine all states into one story when possible.

```typescript
// ──────────────────────────
//    STATES STORIES
// ──────────────────────────

/**
 * Components can exist in various states.
 */
export const States: Story = {
    render: (args) => html`
        ${template({ ...args, 'default-slot': 'Default' })}
        ${template({ ...args, selected: true, 'default-slot': 'Selected' })}
        ${template({ ...args, disabled: true, 'default-slot': 'Disabled' })}
    `,
    tags: ['states'],
    parameters: {
        sectionOrder: 0,
    },
};
```

For complex states (animated, indeterminate), create separate stories:

```typescript
/**
 * Indeterminate state shows unknown progress.
 */
export const Indeterminate: Story = {
    args: { indeterminate: true },
    tags: ['states'],
    parameters: {
        sectionOrder: 1,
    },
};
```

### Step 7: Add Behaviors stories (if applicable)

Document automatic behaviors (text wrapping, truncation), methods, and events.

```typescript
// ──────────────────────────────
//    BEHAVIORS STORIES
// ──────────────────────────────

/**
 * When content is too long, it wraps to multiple lines.
 */
export const TextWrapping: Story = {
    render: () => html`
        ${template({
            ...args,
            'default-slot': 'Long content that wraps to multiple lines',
            styles: { 'max-inline-size': '120px' },
        })}
    `,
    tags: ['behaviors'],
};
```

### Step 8: Add Accessibility story

**Required for every component.** Document features and best practices.

```typescript
// ────────────────────────────────
//    ACCESSIBILITY STORIES
// ────────────────────────────────

/**
 * ### Features
 *
 * The `<swc-component>` element implements several accessibility features:
 *
 * #### Color meaning
 *
 * - Colors are used in combination with text labels and/or icons to ensure that status information is not conveyed through color alone
 * - Users with color vision deficiencies can understand component meaning through text content
 * - High contrast mode is supported with appropriate color overrides
 *
 * #### Non-interactive element
 *
 * - Component has no interactive behavior and are not focusable
 * - Screen readers will announce the component content as static text
 * - No keyboard interaction is required or expected
 *
 * ### Best practices
 *
 * - Use semantic variants (`positive`, `negative`, `notice`, `informative`, `neutral`, `accent`) when the status has specific meaning
 * - Include clear, descriptive labels that explain the status without relying on color alone
 * - For icon-only components, provide descriptive text in the default slot or use the `aria-label` attribute directly on the element
 * - Ensure sufficient color contrast between the badge and its background
 * - Components are not interactive elements - for interactive status indicators, consider using buttons, tags, or links instead
 * - When using multiple components together, ensure they're clearly associated with their related content
 * - Use consistent component variants across your application for the same statuses
 * - Test with screen readers to verify component content is announced in context
 * - Consider placement carefully - components should be close to the content they describe
 */
export const Accessibility: Story = {
    render: () => html`
        ${template({
            ...args,
            variant: 'positive',
            'default-slot': 'Approved',
        })}
        ${template({
            ...args,
            variant: 'negative',
            'default-slot': 'Rejected',
        })}
    `,
    tags: ['a11y'],
};
```

### Step 9: Add helpers (if needed)

Place utility functions at the bottom.

```typescript
// ────────────────────────
//    HELPERS
// ────────────────────────

const sizeLabels = { s: 'Small', m: 'Medium', l: 'Large', xl: 'Extra-large' };

function sizeLabel(size: string): string {
    return sizeLabels[size as keyof typeof sizeLabels] || size;
}
```

---

## Part 2: Create the usage.mdx file

Create `stories/[component].usage.mdx` to display stories organized by section.

## Anatomy

<SpectrumStories tag="anatomy" hideTitle />

## Options

<SpectrumStories tag="options" />

## States

<SpectrumStories tag="states" />

## Behaviors

<SpectrumStories tag="behaviors" />

## Accessibility

<SpectrumStories tag="a11y" hideTitle />
```

**Section rules:**

- Use `hideTitle` for Anatomy and Accessibility only
- Only include sections that have corresponding stories
- Follow the section order shown above
- Use sentence case for headings

---

## Key requirements

### JSDoc comments

Every story **except Playground AND Overview** needs a JSDoc comment explaining:

- What it demonstrates
- Usage guidance or best practices
- When to use each variant/option

Use markdown: `**Bold**`, bullet lists, and backticks for code.

### Accessibility in stories

All stories must demonstrate accessible usage:

- ✅ Include required labels (`label`, `aria-label`, slot content)
- ✅ Use meaningful, realistic content (not "Lorem ipsum")
- ✅ Show proper ARIA attributes
- ❌ Never demonstrate inaccessible patterns

### Layout

Use `flexLayout: 'row-wrap' | 'column-stretch' | 'row-nowrap' | 'column-center'` for stories showing multiple items or elements that need to be aligned:

```typescript
parameters: {
    flexLayout: 'row-wrap';
}
```

Customize with `styles`:

```typescript
parameters: {
    flexLayout: 'row-wrap',
    styles: { alignItems: 'flex-start' }
}
```

### Tags reference

| Tag                   | Usage                                   |
| --------------------- | --------------------------------------- |
| `'autodocs'`, `'dev'` | Playground story only                   |
| `'overview'`          | Overview story only                     |
| `'anatomy'`           | Anatomy stories                         |
| `'options'`           | Options stories (sizes, variants, etc.) |
| `'states'`            | States stories                          |
| `'behaviors'`         | Behaviors stories                       |
| `'a11y'`              | Accessibility story                     |
| `'!test'`             | Exclude from visual regression tests    |
| `'!dev'`              | Exclude from dev Storybook              |

### Image assets

When stories require placeholder images, use the [picsum.photos](https://picsum.photos/) API instead of local image assets. This keeps the repository lightweight and provides consistent, high-quality images.

**Important: Use static IDs for VRT consistency**

Always use static image IDs to ensure visual regression tests (VRTs) produce consistent snapshots. Random images cause false positives in VRT comparisons.

```typescript
// ✅ Good - static ID ensures consistent VRT snapshots
'default-slot': `<img src="https://picsum.photos/id/64/80/80" alt="User avatar" />`

// ❌ Bad - random image causes VRT failures
'default-slot': `<img src="https://picsum.photos/80/80" alt="Random image" />`
```

**URL format:** `https://picsum.photos/id/{ID}/{WIDTH}/{HEIGHT}`

**Recommended static IDs:**

| ID  | Description        | Example URL                          |
| --- | ------------------ | ------------------------------------ |
| 64  | Portrait/avatar    | `https://picsum.photos/id/64/80/80`  |
| 56  | Background/texture | `https://picsum.photos/id/56/80/80`  |
| 823 | Person/profile     | `https://picsum.photos/id/823/80/80` |

**Example usage** (from `asset.stories.ts`):

```typescript
export const Anatomy: Story = {
    render: (args) => html`
        ${template({ ...args, variant: 'file', label: 'README.md' })}
        ${template({ ...args, variant: 'folder', label: 'packages/swc/' })}
        ${template({
            ...args,
            label: 'User avatar',
            'default-slot': `<img src="https://picsum.photos/id/64/80/80" alt="User avatar preview" />`,
        })}
    `,
    tags: ['anatomy'],
};
```

---

## Checklist

Before submitting:

- [ ] Copyright header (2025)
- [ ] Visual separators between all sections
- [ ] Meta object has all required fields including `subtitle` and `tags: ['migrated']`
- [ ] Playground story has `['autodocs', 'dev']` tags and no JSDoc
- [ ] Overview story has `['overview']` tags and no JSDoc
- [ ] Anatomy story documents visual and technical structure
- [ ] Options stories cover all attributes not in other sections
- [ ] Stories use `flexLayout: 'row-wrap' | 'column-stretch' | 'row-nowrap' | 'column-center'` when showing multiple items or elements that need to be aligned
- [ ] Story order controlled with `section-order` parameter
- [ ] All stories have JSDoc comments (except Playground and Overview)
- [ ] All stories are accessible with meaningful content
- [ ] Accessibility story documents features and best practices
- [ ] Image assets use `picsum.photos` with static IDs for VRT consistency (if applicable)
- [ ] usage.mdx uses `<SpectrumStories />` for each section
