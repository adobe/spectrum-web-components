{"version":3,"file":"3f0299b6.js","sources":["../../../tools/theme/src/Theme.js"],"sourcesContent":["\"use strict\";import{supportsAdoptingStyleSheets as h}from\"@spectrum-web-components/base\";import{version as d}from\"@spectrum-web-components/base/src/version.js\";const m=[\"spectrum\",\"express\"],c=[\"medium\",\"large\",\"medium-express\",\"large-express\"],p=[\"light\",\"lightest\",\"dark\",\"darkest\",\"light-express\",\"lightest-express\",\"dark-express\",\"darkest-express\"],a=class a extends HTMLElement{constructor(){super();this._dir=\"\";this._theme=\"spectrum\";this._color=\"\";this._scale=\"\";this.trackedChildren=new Set;this._updateRequested=!1;this._contextConsumers=new Map;this.attachShadow({mode:\"open\"});const e=document.importNode(a.template.content,!0);this.shadowRoot.appendChild(e),this.shouldAdoptStyles(),this.addEventListener(\"sp-query-theme\",this.onQueryTheme),this.addEventListener(\"sp-language-context\",this._handleContextPresence),this.updateComplete=this.__createDeferredPromise()}static get observedAttributes(){return[\"color\",\"scale\",\"theme\",\"lang\",\"dir\"]}set dir(e){if(e===this.dir)return;this.setAttribute(\"dir\",e),this._dir=e;const t=e===\"rtl\"?e:\"ltr\";this.trackedChildren.forEach(s=>{s.setAttribute(\"dir\",t)})}get dir(){return this._dir}attributeChangedCallback(e,t,s){t!==s&&(e===\"color\"?this.color=s:e===\"scale\"?this.scale=s:e===\"lang\"&&s?(this.lang=s,this._provideContext()):e===\"theme\"?this.theme=s:e===\"dir\"&&(this.dir=s))}requestUpdate(){window.ShadyCSS!==void 0&&!window.ShadyCSS.nativeShadow?window.ShadyCSS.styleElement(this):this.shouldAdoptStyles()}get theme(){const e=a.themeFragmentsByKind.get(\"theme\"),{name:t}=e&&e.get(\"default\")||{};return this._theme||t||\"\"}set theme(e){if(e===this._theme)return;const t=e&&m.includes(e)?e:this.theme;t!==this._theme&&(this._theme=t,this.requestUpdate()),t?this.setAttribute(\"theme\",t):this.removeAttribute(\"theme\")}get color(){const e=a.themeFragmentsByKind.get(\"color\"),{name:t}=e&&e.get(\"default\")||{};return this._color||t||\"\"}set color(e){if(e===this._color)return;const t=e&&p.includes(e)?e:this.color;t!==this._color&&(this._color=t,this.requestUpdate()),t?this.setAttribute(\"color\",t):this.removeAttribute(\"color\")}get scale(){const e=a.themeFragmentsByKind.get(\"scale\"),{name:t}=e&&e.get(\"default\")||{};return this._scale||t||\"\"}set scale(e){if(e===this._scale)return;const t=e&&c.includes(e)?e:this.scale;t!==this._scale&&(this._scale=t,this.requestUpdate()),t?this.setAttribute(\"scale\",t):this.removeAttribute(\"scale\")}get styles(){const e=[...a.themeFragmentsByKind.keys()],t=(r,i,n)=>{const o=n&&n!==\"theme\"&&this.theme===\"express\"?r.get(`${i}-express`):r.get(i),l=i===\"spectrum\"||!n||this.hasAttribute(n);if(o&&l)return o.styles};return[...e.reduce((r,i)=>{const n=a.themeFragmentsByKind.get(i);let o;if(i===\"app\"||i===\"core\")o=t(n,i);else{const{[i]:l}=this;o=t(n,l,i)}return o&&r.push(o),r},[])]}static get template(){return this.templateElement||(this.templateElement=document.createElement(\"template\"),this.templateElement.innerHTML=\"<slot></slot>\"),this.templateElement}__createDeferredPromise(){return new Promise(e=>{this.__resolve=e})}onQueryTheme(e){if(e.defaultPrevented)return;e.preventDefault();const{detail:t}=e;t.color=this.color||void 0,t.scale=this.scale||void 0,t.lang=this.lang||document.documentElement.lang||navigator.language,t.theme=this.theme||void 0}connectedCallback(){if(this.shouldAdoptStyles(),window.ShadyCSS!==void 0&&window.ShadyCSS.styleElement(this),a.instances.add(this),!this.hasAttribute(\"dir\")){let e=this.assignedSlot||this.parentNode;for(;e!==document.documentElement&&!(e instanceof a);)e=e.assignedSlot||e.parentNode||e.host;this.dir=e.dir===\"rtl\"?e.dir:\"ltr\"}}disconnectedCallback(){a.instances.delete(this)}startManagingContentDirection(e){this.trackedChildren.add(e)}stopManagingContentDirection(e){this.trackedChildren.delete(e)}async shouldAdoptStyles(){this._updateRequested||(this.updateComplete=this.__createDeferredPromise(),this._updateRequested=!0,this._updateRequested=await!1,this.adoptStyles(),this.__resolve(!0))}adoptStyles(){const e=this.styles;if(window.ShadyCSS!==void 0&&!window.ShadyCSS.nativeShadow&&window.ShadyCSS.ScopingShim){const t=[];for(const[s,r]of a.themeFragmentsByKind)for(const[i,{styles:n}]of r){if(i===\"default\")continue;let o=n.cssText;a.defaultFragments.has(i)||(o=o.replace(\":host\",`:host([${s}='${i}'])`)),t.push(o)}window.ShadyCSS.ScopingShim.prepareAdoptedCssText(t,this.localName),window.ShadyCSS.prepareTemplate(a.template,this.localName)}else if(h){const t=[];for(const s of e)t.push(s.styleSheet);this.shadowRoot.adoptedStyleSheets=t}else this.shadowRoot.querySelectorAll(\"style\").forEach(s=>s.remove()),e.forEach(s=>{const r=document.createElement(\"style\");r.textContent=s.cssText,this.shadowRoot.appendChild(r)})}static registerThemeFragment(e,t,s){const r=a.themeFragmentsByKind.get(t)||new Map;r.size===0&&(a.themeFragmentsByKind.set(t,r),r.set(\"default\",{name:e,styles:s}),a.defaultFragments.add(e)),r.set(e,{name:e,styles:s}),a.instances.forEach(i=>i.shouldAdoptStyles())}_provideContext(){this._contextConsumers.forEach(([e,t])=>e(this.lang,t))}_handleContextPresence(e){e.stopPropagation();const t=e.composedPath()[0];if(this._contextConsumers.has(t))return;this._contextConsumers.set(t,[e.detail.callback,()=>this._contextConsumers.delete(t)]);const[s,r]=this._contextConsumers.get(t)||[];s&&r&&s(this.lang||document.documentElement.lang||navigator.language,r)}};a.themeFragmentsByKind=new Map,a.defaultFragments=new Set([\"spectrum\"]),a.instances=new Set,a.VERSION=d;export let Theme=a;\n//# sourceMappingURL=Theme.js.map\n"],"names":["ScaleValues","ColorValues","_Theme","HTMLElement","constructor","super","this","_dir","_theme","_color","_scale","trackedChildren","Set","_updateRequested","_contextConsumers","Map","attachShadow","mode","node","document","importNode","template","content","shadowRoot","appendChild","shouldAdoptStyles","addEventListener","onQueryTheme","_handleContextPresence","updateComplete","__createDeferredPromise","observedAttributes","dir","setAttribute","forEach","el","targetDir","attrName","old","value","color","scale","lang","_provideContext","theme","requestUpdate","window","ShadyCSS","nativeShadow","styleElement","themeFragmentsByKind","get","name","themeFragments","newValue","ThemeVariantValues","includes","removeAttribute","styles","themeKinds","keys","getStyle","fragments","kind","isAppliedFragment","hasAttribute","currentStyles","reduce","acc","style","kindFragments","i","push","templateElement","createElement","innerHTML","resolve","__resolve","event","defaultPrevented","preventDefault","detail","documentElement","navigator","language","connectedCallback","instances","add","assignedSlot","parentNode","dirParent","a","host","disconnectedCallback","delete","async","adoptStyles","ScopingShim","t","r","cssText","defaultFragments","has","replace","fragmentCSS","prepareAdoptedCssText","localName","prepareTemplate","supportsAdoptingStyleSheets","s","e","styleSheets","styleSheet","adoptedStyleSheets","querySelectorAll","element","remove","textContent","static","fragmentMap","size","set","instance","callback","unsubscribe","stopPropagation","composedPath","target","VERSION","version","Theme"],"mappings":"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"}