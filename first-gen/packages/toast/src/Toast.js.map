{
  "version": 3,
  "sources": ["Toast.ts"],
  "sourcesContent": ["/**\n * Copyright 2025 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {\n    CSSResultArray,\n    html,\n    PropertyValues,\n    SpectrumElement,\n    TemplateResult,\n} from '@spectrum-web-components/base';\nimport { property } from '@spectrum-web-components/base/src/decorators.js';\nimport '@spectrum-web-components/button/sp-close-button.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-alert.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-info.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-checkmark-circle.js';\nimport { FocusVisiblePolyfillMixin } from '@spectrum-web-components/shared/src/focus-visible.js';\n\nimport toastStyles from './toast.css.js';\n\nexport const toastVariants: ToastVariants[] = [\n    'negative',\n    'positive',\n    'info',\n    'error',\n    'warning',\n];\n\nexport type ToastVariants =\n    | 'negative'\n    | 'positive'\n    | 'info'\n    | 'error'\n    | 'warning'\n    | '';\n\n/**\n * @element sp-toast\n *\n * @slot - The toast content\n * @slot action - button element surfacing an action in the Toast\n *\n * @fires close - Announces that the Toast has been closed by the user or by its timeout.\n */\n\nexport class Toast extends FocusVisiblePolyfillMixin(SpectrumElement) {\n    public static override get styles(): CSSResultArray {\n        return [toastStyles];\n    }\n\n    /**\n     * The `open` property indicates whether the toast is visible or hidden.\n     *\n     * @param {Boolean} open\n     */\n    @property({ type: Boolean, reflect: true })\n    public open = false;\n\n    /**\n     * When a timeout is provided, it represents the number of milliseconds from when\n     * the Toast was placed on the page before it will automatically dismiss itself.\n     *\n     * Accessibility concerns require that a Toast is available for at least 6000ms\n     * before being dismissed, so any timeout of less than 6000ms will be raised to\n     * that baseline.\n     *\n     * It is suggested that messages longer than 120 words should receive an additional\n     * 1000ms in their timeout for each additional 120 words in the message.\n     *\n     * For example, a message with 240 words should have a timeout of 7000ms,\n     * and a message with 360 words should have a timeout of 8000ms.\n     *\n     * @param {Number | null} timeout\n     * @default null\n     */\n    //TODO(#4939): Align on the timeout minimum with design\n    @property({ type: Number })\n    public set timeout(timeout: number | null) {\n        const hasTimeout = typeof timeout !== null && (timeout as number) > 0;\n        const newTimeout = hasTimeout\n            ? Math.max(6000, timeout as number)\n            : null;\n        const oldValue = this.timeout;\n        if (newTimeout && this.countdownStart) {\n            this.countdownStart = performance.now();\n        }\n        this._timeout = newTimeout;\n        this.requestUpdate('timeout', oldValue);\n    }\n\n    public get timeout(): number | null {\n        return this._timeout;\n    }\n\n    private _timeout: number | null = null;\n\n    /**\n     * The variant applies specific styling when set to `negative`, `positive`, `info`, `error`, or `warning`.\n     *\n     * The variants `error` and `warning` are deprecated and should be replaced with `negative`.\n     *\n     * `variant` attribute is removed when not matching one of the above.\n     *\n     * @param {String} variant\n     */\n    @property({ type: String })\n    public set variant(variant: ToastVariants) {\n        if (variant === this.variant) {\n            return;\n        }\n        const oldValue = this.variant;\n\n        // validate the variant is one of the allowed values else remove the attribute\n        if (toastVariants.includes(variant)) {\n            this.setAttribute('variant', variant);\n            this._variant = variant;\n        } else {\n            this.removeAttribute('variant');\n            this._variant = '';\n        }\n        this.requestUpdate('variant', oldValue);\n    }\n\n    public get variant(): ToastVariants {\n        return this._variant;\n    }\n\n    private _variant: ToastVariants = '';\n\n    /**\n     * The `iconLabel` property is used to set the `label` attribute on the icon element. This is used to provide a text alternative for the icon to ensure accessibility.\n     *\n     * If the `iconLabel` property is not set, the icon will use the `variant` to dynamically set the `label`.\n     *\n     * @param {String} iconLabel\n     */\n    @property({ type: String, attribute: 'icon-label' })\n    public iconLabel?: string;\n\n    //TODO(#4931): Address the deprecated variants or remove the flags\n    private renderIcon(\n        variant: ToastVariants,\n        iconLabel?: string\n    ): TemplateResult {\n        switch (variant) {\n            case 'info':\n                return html`\n                    <sp-icon-info\n                        label=${iconLabel || 'Information'}\n                        class=\"type\"\n                    ></sp-icon-info>\n                `;\n            case 'negative':\n            case 'error': // deprecated\n                return html`\n                    <sp-icon-alert\n                        label=${iconLabel || 'Error'}\n                        class=\"type\"\n                    ></sp-icon-alert>\n                `;\n            case 'warning': // deprecated\n                return html`\n                    <sp-icon-alert\n                        label=${iconLabel || 'Warning'}\n                        class=\"type\"\n                    ></sp-icon-alert>\n                `;\n            case 'positive':\n                return html`\n                    <sp-icon-checkmark-circle\n                        label=${iconLabel || 'Success'}\n                        class=\"type\"\n                    ></sp-icon-checkmark-circle>\n                `;\n            default:\n                return html``;\n        }\n    }\n\n    private countdownStart = 0;\n    private nextCount = -1;\n\n    private doCountdown = (time: number): void => {\n        if (!this.countdownStart) {\n            this.countdownStart = performance.now();\n        }\n        if (time - this.countdownStart > (this._timeout as number)) {\n            this.shouldClose();\n            this.countdownStart = 0;\n        } else {\n            this.countdown();\n        }\n    };\n\n    private countdown = (): void => {\n        cancelAnimationFrame(this.nextCount);\n        this.nextCount = requestAnimationFrame(this.doCountdown);\n    };\n\n    private holdCountdown = (): void => {\n        this.stopCountdown();\n        this.addEventListener('focusout', this.resumeCountdown);\n    };\n\n    private resumeCountdown = (): void => {\n        this.removeEventListener('focusout', this.holdCountdown);\n        this.countdown();\n    };\n\n    private startCountdown(): void {\n        this.countdown();\n        this.addEventListener('focusin', this.holdCountdown);\n    }\n\n    private stopCountdown(): void {\n        cancelAnimationFrame(this.nextCount);\n        this.countdownStart = 0;\n    }\n\n    private shouldClose(): void {\n        const applyDefault = this.dispatchEvent(\n            new CustomEvent('close', {\n                composed: true,\n                bubbles: true,\n                cancelable: true,\n            })\n        );\n        if (applyDefault) {\n            this.close();\n        }\n    }\n\n    public close(): void {\n        this.open = false;\n    }\n\n    protected override render(): TemplateResult {\n        return html`\n            ${this.renderIcon(this.variant, this.iconLabel)}\n            <div class=\"body\" role=\"alert\">\n                <div class=\"content\">\n                    <slot></slot>\n                </div>\n                <slot name=\"action\"></slot>\n            </div>\n            <div class=\"buttons\">\n                <sp-close-button\n                    @click=${this.shouldClose}\n                    label=\"Close\"\n                    static-color=\"white\"\n                ></sp-close-button>\n            </div>\n        `;\n    }\n\n    protected override updated(changes: PropertyValues): void {\n        super.updated(changes);\n        if (changes.has('open')) {\n            if (this.open) {\n                if (this.timeout) {\n                    this.startCountdown();\n                }\n            } else {\n                if (this.timeout) {\n                    this.stopCountdown();\n                }\n            }\n        }\n        if (changes.has('timeout')) {\n            if (this.timeout !== null && this.open) {\n                this.startCountdown();\n            } else {\n                this.stopCountdown();\n            }\n        }\n    }\n}\n"],
  "mappings": "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",
  "names": ["html", "SpectrumElement", "property", "FocusVisiblePolyfillMixin", "toastStyles", "time", "timeout", "newTimeout", "oldValue", "variant", "iconLabel", "changes", "__decorateClass"]
}
