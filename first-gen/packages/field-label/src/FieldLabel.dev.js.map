{
  "version": 3,
  "sources": ["FieldLabel.ts"],
  "sourcesContent": ["/**\n * Copyright 2025 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {\n    CSSResultArray,\n    html,\n    nothing,\n    PropertyValues,\n    SizedMixin,\n    SpectrumElement,\n    TemplateResult,\n} from '@spectrum-web-components/base';\nimport {\n    property,\n    query,\n} from '@spectrum-web-components/base/src/decorators.js';\nimport type { Focusable } from '@spectrum-web-components/shared';\nimport { randomID } from '@spectrum-web-components/shared/src/random-id.js';\nimport '@spectrum-web-components/icons-ui/icons/sp-icon-asterisk100.js';\nimport asteriskIconStyles from '@spectrum-web-components/icon/src/spectrum-icon-asterisk.css.js';\nimport {\n    conditionAttributeWithId,\n    conditionAttributeWithoutId,\n} from '@spectrum-web-components/base/src/condition-attribute-with-id.js';\nimport {\n    ElementResolutionController,\n    elementResolverUpdatedSymbol,\n} from '@spectrum-web-components/reactive-controllers/src/ElementResolution.js';\n\nimport styles from './field-label.css.js';\n\ntype AcceptsFocusVisisble = HTMLElement & { forceFocusVisible?(): void };\ntype Labelable = Focusable & {\n    applyFocusElementLabel?: (\n        appliedLabel: string,\n        labelElement?: FieldLabel\n    ) => void;\n};\n\n/**\n * @element sp-field-label\n *\n * @slot - text content of the label\n */\nexport class FieldLabel extends SizedMixin(SpectrumElement, {\n    noDefaultSize: true,\n}) {\n    public static override get styles(): CSSResultArray {\n        return [styles, asteriskIconStyles];\n    }\n\n    @property({ type: Boolean, reflect: true })\n    public disabled = false;\n\n    @property({ type: String })\n    public override id = '';\n\n    @property({ type: String })\n    public for = '';\n\n    @property({ type: Boolean, reflect: true })\n    public required = false;\n\n    @query('slot')\n    public slotEl!: HTMLSlotElement;\n\n    @property({ type: String, reflect: true, attribute: 'side-aligned' })\n    public sideAligned?: 'start' | 'end';\n\n    private target?: Labelable;\n\n    private handleClick(event: Event): void {\n        if (!this.target || this.disabled || event.defaultPrevented) return;\n        this.target.focus();\n        const parent = this.getRootNode() as ShadowRoot;\n        const target = this.target as AcceptsFocusVisisble;\n        const targetParent = target.getRootNode() as ShadowRoot;\n        const targetHost = targetParent.host as AcceptsFocusVisisble;\n        if (targetParent === parent && target.forceFocusVisible) {\n            target.forceFocusVisible();\n        } else if (targetHost && targetHost.forceFocusVisible) {\n            targetHost.forceFocusVisible();\n        }\n    }\n\n    private resolvedElement = new ElementResolutionController(this);\n\n    private applyTargetLabel(target?: Labelable): void {\n        // Apply new target when provided\n        this.target = target || this.target;\n        if (this.target) {\n            // When target is available add or remove label information\n            // depending on the value of `apply`.\n            const applyLabel = this.target.applyFocusElementLabel;\n            const focusable = this.target.focusElement || this.target;\n            const targetParent = focusable.getRootNode() as HTMLElement;\n            if (typeof applyLabel !== 'undefined') {\n                applyLabel(this.labelText, this);\n            } else if (targetParent === (this.getRootNode() as HTMLElement)) {\n                const conditionAttribute = target\n                    ? conditionAttributeWithId\n                    : conditionAttributeWithoutId;\n                conditionAttribute(focusable, 'aria-labelledby', [this.id]);\n            } else {\n                if (target) {\n                    focusable.setAttribute('aria-label', this.labelText);\n                } else {\n                    focusable.removeAttribute('aria-label');\n                }\n            }\n        }\n    }\n\n    private async manageTarget(): Promise<void> {\n        this.applyTargetLabel();\n        const target = this.resolvedElement.element as Focusable;\n        if (!target) {\n            this.target = target;\n            return;\n        }\n        if (target.localName.search('-') > 0) {\n            await customElements.whenDefined(target.localName);\n        }\n        if (typeof target.updateComplete !== 'undefined') {\n            await target.updateComplete;\n        }\n        this.applyTargetLabel(target);\n    }\n\n    private get labelText(): string {\n        const assignedNodes = this.slotEl.assignedNodes({ flatten: true });\n        if (!assignedNodes.length) {\n            return '';\n        }\n        const labelText = assignedNodes.map((node) =>\n            (node.textContent || /* c8 ignore next */ '').trim()\n        );\n        return labelText.join(' ');\n    }\n\n    protected override render(): TemplateResult {\n        return html`\n            <label>\n                <slot></slot>\n                ${this.required\n                    ? html`\n                          <sp-icon-asterisk100\n                              class=\"required-icon spectrum-UIIcon-Asterisk100\"\n                          ></sp-icon-asterisk100>\n                      `\n                    : nothing}\n            </label>\n        `;\n    }\n\n    protected override firstUpdated(changes: PropertyValues): void {\n        super.firstUpdated(changes);\n        this.addEventListener('click', this.handleClick);\n    }\n\n    protected override willUpdate(changes: PropertyValues): void {\n        if (!this.hasAttribute('id')) {\n            this.setAttribute(\n                'id',\n                `${this.tagName.toLowerCase()}-${randomID()}`\n            );\n        }\n        if (changes.has('for')) {\n            this.resolvedElement.selector = this.for ? `#${this.for}` : '';\n        }\n        if (changes.has('id') || changes.has(elementResolverUpdatedSymbol)) {\n            this.manageTarget();\n        }\n    }\n}\n"],
  "mappings": "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",
  "names": []
}
