{
  "version": 3,
  "sources": ["Sidenav.ts"],
  "sourcesContent": ["/**\n * Copyright 2025 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {\n    CSSResultArray,\n    html,\n    PropertyValues,\n    TemplateResult,\n} from '@spectrum-web-components/base';\nimport { property } from '@spectrum-web-components/base/src/decorators.js';\nimport { RovingTabindexController } from '@spectrum-web-components/reactive-controllers/src/RovingTabindex.js';\n\nimport sidenavStyles from './sidenav.css.js';\nimport { Focusable } from '@spectrum-web-components/shared';\nimport { SideNavItem } from './SidenavItem.dev.js'\nimport { SideNavHeading } from './SidenavHeading.dev.js'\nimport { ifDefined } from '@spectrum-web-components/base/src/directives.js';\n\nexport interface SidenavSelectDetail {\n    value: string;\n}\n\n/**\n * @element sp-sidenav\n *\n * @slot - the Sidenav Items to display\n * @fires change - Announces a change in the `value` property of the navigation element.\n * This change can be \"canceled\" via `event.preventDefault()`.\n */\nexport class SideNav extends Focusable {\n    public static override get styles(): CSSResultArray {\n        return [sidenavStyles];\n    }\n\n    private items = new Set<SideNavItem>();\n\n    public startTrackingSelectionForItem(item: SideNavItem): void {\n        this.items.add(item);\n        this.rovingTabindexController.clearElementCache();\n    }\n\n    public stopTrackingSelectionForItem(item: SideNavItem): void {\n        this.items.delete(item);\n        this.rovingTabindexController.clearElementCache();\n    }\n\n    rovingTabindexController = new RovingTabindexController<SideNavItem>(this, {\n        focusInIndex: (elements: SideNavItem[]) => {\n            let parentSideNavItem: SideNavItem | undefined;\n            let index = elements.findIndex((el) => {\n                // If the selected item's parent is collapsed, save it for later.\n                if (el.value === this.value && this.isDisabledChild(el)) {\n                    parentSideNavItem = el.closest(\n                        'sp-sidenav-item:not([expanded])'\n                    ) as SideNavItem;\n                }\n                return this.value\n                    ? !el.disabled &&\n                          !this.isDisabledChild(el) &&\n                          el.value === this.value\n                    : !el.disabled && !this.isDisabledChild(el);\n            });\n            // If the selected item's parent is collapsed, focus the collapsed parent.\n            if (index === -1 && parentSideNavItem) {\n                index = elements.findIndex((el) => el === parentSideNavItem);\n            }\n            return index;\n        },\n        direction: 'vertical',\n        elements: () =>\n            [...this.querySelectorAll('sp-sidenav-item')] as SideNavItem[],\n        isFocusableElement: (el: SideNavItem) =>\n            !el.disabled && !this.isDisabledChild(el),\n    });\n\n    @property({ type: Boolean, reflect: true, attribute: 'manage-tab-index' })\n    public manageTabIndex = false;\n\n    @property({ reflect: true })\n    public value: string | undefined = undefined;\n\n    /**\n     * The multilevel variant will have multiple layers of hierarchical navigation items.\n     */\n    @property({ reflect: true })\n    public variant?: 'multilevel' = undefined;\n\n    /**\n     * An accessible label that describes the component,\n     * so that the side navigation can be distinguished\n     * from other navigation by screen reader users.\n     * It will be applied to aria-label, but not visually rendered.\n     */\n    @property({ reflect: true })\n    public label?: string | undefined = undefined;\n\n    private handleSelect(\n        event: CustomEvent<SidenavSelectDetail> & { target: SideNavItem }\n    ): void {\n        event.stopPropagation();\n        if (this.value === event.detail.value) {\n            return;\n        }\n        const oldValue = this.value;\n        this.value = event.detail.value;\n        const applyDefault = this.dispatchEvent(\n            new Event('change', {\n                bubbles: true,\n                composed: true,\n                cancelable: true,\n            })\n        );\n        if (!applyDefault) {\n            this.value = oldValue;\n            event.target.selected = false;\n            event.preventDefault();\n        } else {\n            this.items.forEach((item) => item.handleSideNavSelect(event));\n        }\n    }\n\n    public override focus(): void {\n        this.rovingTabindexController.focus();\n    }\n\n    public override blur(): void {\n        if (this.focusElement === this) {\n            return;\n        }\n\n        super.blur();\n    }\n\n    public override click(): void {\n        if (this.focusElement === this) {\n            return;\n        }\n\n        super.click();\n    }\n\n    public override get focusElement(): SideNavItem | SideNav {\n        return this.rovingTabindexController.focusInElement || this;\n    }\n\n    private isDisabledChild(child: SideNavItem): boolean {\n        if (child.disabled) {\n            return true;\n        }\n        let parent = child.parentElement as\n            | SideNavItem\n            | SideNav\n            | SideNavHeading;\n        while (\n            parent instanceof SideNavHeading ||\n            (!(parent as SideNavItem).disabled &&\n                parent instanceof SideNavItem &&\n                parent.expanded)\n        ) {\n            parent = parent.parentElement as\n                | SideNavItem\n                | SideNav\n                | SideNavHeading;\n        }\n        return parent !== this;\n    }\n\n    private handleSlotchange(): void {\n        if (this.manageTabIndex) {\n            this.rovingTabindexController.manage();\n        } else {\n            this.rovingTabindexController.unmanage();\n        }\n    }\n\n    protected override render(): TemplateResult {\n        return html`\n            <nav\n                @sidenav-select=${this.handleSelect}\n                aria-label=${ifDefined(this.label)}\n            >\n                <div role=\"list\">\n                    <slot\n                        name=\"descendant\"\n                        @slotchange=${this.handleSlotchange}\n                    ></slot>\n                </div>\n            </nav>\n        `;\n    }\n\n    protected override willUpdate(): void {\n        if (!this.hasUpdated) {\n            const selectedChild = this.querySelector(\n                '[selected]'\n            ) as SideNavItem;\n            if (selectedChild) {\n                this.value = selectedChild.value;\n            }\n        }\n    }\n\n    protected override updated(changes: PropertyValues): void {\n        super.updated(changes);\n        if (changes.has('manageTabIndex')) {\n            if (this.manageTabIndex) {\n                this.rovingTabindexController.manage();\n            } else {\n                this.rovingTabindexController.unmanage();\n            }\n        }\n    }\n}\n\ndeclare global {\n    interface GlobalEventHandlersEventMap {\n        'sp-sidenav:select': CustomEvent<SidenavSelectDetail>;\n    }\n}\n"],
  "mappings": "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",
  "names": []
}
