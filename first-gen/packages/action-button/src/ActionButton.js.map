{
  "version": 3,
  "sources": ["ActionButton.ts"],
  "sourcesContent": ["/**\n * Copyright 2025 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {\n    CSSResultArray,\n    DefaultElementSize,\n    html,\n    PropertyValues,\n    SizedMixin,\n    TemplateResult,\n} from '@spectrum-web-components/base';\nimport { property } from '@spectrum-web-components/base/src/decorators.js';\nimport { ButtonBase } from '@spectrum-web-components/button';\nimport buttonStyles from './action-button.css.js';\nimport cornerTriangleStyles from '@spectrum-web-components/icon/src/spectrum-icon-corner-triangle.css.js';\nimport '@spectrum-web-components/icons-ui/icons/sp-icon-corner-triangle300.js';\n\nconst holdAffordanceClass = {\n    xs: 'spectrum-UIIcon-CornerTriangle75',\n    s: 'spectrum-UIIcon-CornerTriangle75',\n    m: 'spectrum-UIIcon-CornerTriangle100',\n    l: 'spectrum-UIIcon-CornerTriangle200',\n    xl: 'spectrum-UIIcon-CornerTriangle300',\n};\n\nexport const LONGPRESS_DURATION = 300;\nlet LONGPRESS_TIMEOUT: ReturnType<typeof setTimeout>;\n\nexport type LongpressEvent = {\n    source: 'pointer' | 'keyboard';\n};\n\n/**\n * @element sp-action-button\n *\n * @slot - text label of the Action Button\n * @slot icon - The icon to use for Action Button\n * @fires change - Announces a change in the `selected` property of an action button\n * @fires longpress - Synthesizes a \"longpress\" interaction that signifies a\n * `pointerdown` event that is >=300ms or a keyboard event where code is `Space` or code is `ArrowDown`\n * while `altKey===true`.\n */\nexport class ActionButton extends SizedMixin(ButtonBase, {\n    validSizes: ['xs', 's', 'm', 'l', 'xl'],\n    noDefaultSize: true,\n}) {\n    public static override get styles(): CSSResultArray {\n        return [...super.styles, buttonStyles, cornerTriangleStyles];\n    }\n\n    @property({ type: Boolean, reflect: true })\n    public emphasized = false;\n\n    @property({ type: Boolean, reflect: true, attribute: 'hold-affordance' })\n    public holdAffordance = false;\n\n    @property({ type: Boolean, reflect: true })\n    public quiet = false;\n\n    @property({ reflect: true })\n    public override role = 'button';\n\n    /**\n     * Whether an Action Button with `role='button'`\n     * should also be `aria-pressed='true'`\n     */\n    @property({ type: Boolean, reflect: true })\n    public selected = false;\n\n    /**\n     * Whether to automatically manage the `selected`\n     * attribute on interaction and whether `aria-pressed=\"false\"`\n     * should be used when `selected === false`\n     */\n    @property({ type: Boolean, reflect: true })\n    public toggles = false;\n\n    /**\n     * The static color variant to use for the action button.\n     */\n    @property({ reflect: true, attribute: 'static-color' })\n    public staticColor?: 'white' | 'black';\n\n    @property({ type: String })\n    public get value(): string {\n        return this._value || this.itemText;\n    }\n    public set value(value: string) {\n        if (value === this._value) {\n            return;\n        }\n        this._value = value || '';\n        if (this._value) {\n            this.setAttribute('value', this._value);\n        } else {\n            this.removeAttribute('value');\n        }\n    }\n    private _value = '';\n\n    /**\n     * @private\n     */\n    public get itemText(): string {\n        return (this.textContent || /* c8 ignore next */ '').trim();\n    }\n\n    constructor() {\n        super();\n        this.addEventListener('click', this.onClick);\n    }\n\n    private onClick = (): void => {\n        if (!this.toggles) {\n            return;\n        }\n        this.selected = !this.selected;\n        const applyDefault = this.dispatchEvent(\n            new Event('change', {\n                cancelable: true,\n                bubbles: true,\n                composed: true,\n            })\n        );\n        if (!applyDefault) {\n            this.selected = !this.selected;\n        }\n    };\n\n    private handlePointerdownHoldAffordance(event: PointerEvent): void {\n        if (event.button !== 0) return;\n        this.addEventListener('pointerup', this.handlePointerupHoldAffordance);\n        this.addEventListener(\n            'pointercancel',\n            this.handlePointerupHoldAffordance\n        );\n        LONGPRESS_TIMEOUT = setTimeout(() => {\n            this.dispatchEvent(\n                new CustomEvent<LongpressEvent>('longpress', {\n                    bubbles: true,\n                    composed: true,\n                    detail: {\n                        source: 'pointer',\n                    },\n                })\n            );\n        }, LONGPRESS_DURATION);\n    }\n\n    private handlePointerupHoldAffordance(): void {\n        clearTimeout(LONGPRESS_TIMEOUT);\n        this.removeEventListener(\n            'pointerup',\n            this.handlePointerupHoldAffordance\n        );\n        this.removeEventListener(\n            'pointercancel',\n            this.handlePointerupHoldAffordance\n        );\n    }\n\n    /**\n     * @private\n     */\n    protected override handleKeydown(event: KeyboardEvent): void {\n        if (!this.holdAffordance) {\n            return super.handleKeydown(event);\n        }\n        const { code, altKey } = event;\n        if (code === 'Space' || (altKey && code === 'ArrowDown')) {\n            event.preventDefault();\n            if (code === 'ArrowDown') {\n                event.stopPropagation();\n                event.stopImmediatePropagation();\n            }\n            this.addEventListener('keyup', this.handleKeyup);\n            this.active = true;\n        }\n    }\n\n    protected override handleKeyup(event: KeyboardEvent): void {\n        if (!this.holdAffordance) {\n            return super.handleKeyup(event);\n        }\n        const { code, altKey } = event;\n        if (code === 'Space' || (altKey && code === 'ArrowDown')) {\n            event.stopPropagation();\n            this.dispatchEvent(\n                new CustomEvent<LongpressEvent>('longpress', {\n                    bubbles: true,\n                    composed: true,\n                    detail: {\n                        source: 'keyboard',\n                    },\n                })\n            );\n            this.active = false;\n        }\n    }\n\n    protected override get buttonContent(): TemplateResult[] {\n        const buttonContent = super.buttonContent;\n        if (this.holdAffordance) {\n            buttonContent.unshift(html`\n                <sp-icon-corner-triangle300\n                    class=\"hold-affordance ${holdAffordanceClass[\n                        this.size as DefaultElementSize\n                    ]}\"\n                ></sp-icon-corner-triangle300>\n            `);\n        }\n        return buttonContent;\n    }\n\n    protected override updated(changes: PropertyValues): void {\n        super.updated(changes);\n        const isButton = this.role === 'button';\n        const canBePressed =\n            isButton &&\n            (this.selected || this.toggles) &&\n            !(\n                this.hasAttribute('aria-haspopup') &&\n                this.hasAttribute('aria-expanded')\n            );\n        if (changes.has('selected') || changes.has('role')) {\n            // When role !== 'button' then the Action Button is within\n            // an Action Group that manages selects which means the\n            // Action Button is a \"checkbox\" or \"radio\" and cannot\n            // accept the `aria-pressed` attribute.\n            if (canBePressed) {\n                this.setAttribute(\n                    'aria-pressed',\n                    this.selected ? 'true' : 'false'\n                );\n            } else {\n                // When !this.toggles the lack of \"aria-pressed\" is inconsequential.\n                this.removeAttribute('aria-pressed');\n                if (\n                    isButton &&\n                    this.toggles &&\n                    this.hasAttribute('aria-expanded')\n                ) {\n                    this.setAttribute(\n                        'aria-expanded',\n                        this.selected ? 'true' : 'false'\n                    );\n                }\n            }\n        }\n        if (changes.has('holdAffordance')) {\n            if (this.holdAffordance) {\n                this.addEventListener(\n                    'pointerdown',\n                    this.handlePointerdownHoldAffordance\n                );\n            } else {\n                this.removeEventListener(\n                    'pointerdown',\n                    this.handlePointerdownHoldAffordance\n                );\n                this.handlePointerupHoldAffordance();\n            }\n        }\n    }\n}\n\ndeclare global {\n    interface GlobalEventHandlersEventMap {\n        longpress: CustomEvent<LongpressEvent>;\n    }\n}\n"],
  "mappings": "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",
  "names": ["html", "SizedMixin", "property", "ButtonBase", "buttonStyles", "cornerTriangleStyles", "holdAffordanceClass", "LONGPRESS_TIMEOUT", "value", "event", "code", "altKey", "buttonContent", "changes", "isButton", "canBePressed", "__decorateClass"]
}
