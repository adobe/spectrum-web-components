"use strict";var l=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var s=(d,o,e,i)=>{for(var t=i>1?void 0:i?h(o,e):o,r=d.length-1,n;r>=0;r--)(n=d[r])&&(t=(i?n(o,e,t):n(t))||t);return i&&t&&l(o,e,t),t};import{adoptStyles as p,html as u,render as c}from"@spectrum-web-components/base";import{property as a}from"@spectrum-web-components/base/src/decorators.js";import{LitVirtualizer as m}from"@lit-labs/virtualizer/LitVirtualizer.js";import{grid as g}from"@lit-labs/virtualizer/layouts/grid.js";import f from"./grid.css.js";import{GridController as b}from"./GridController.js";export class Grid extends m{constructor(){super(...arguments);this.__gridPart=void 0;this.gap="0";this.items=[];this.itemSize={width:200,height:200};this.selected=[];this.gridController=new b(this,{elements:()=>[],itemSize:()=>this.itemSize,gap:()=>this.gap,padding:()=>this.padding||this.gap})}static get styles(){return[f]}handleChange(e){const i=e.target;if(this.lastTargetForChange===i)return;this.lastTargetForChange=i,this.animationFrameId=requestAnimationFrame(()=>{this.lastTargetForChange=void 0});const t=this.items[parseFloat(i.getAttribute("key")||"")],r=[...this.selected];if(!r.includes(t))r.push(t);else{const n=r.indexOf(t);n>-1&&r.splice(n,1)}this.selected=r}createRenderRoot(){var i;const e=(i=this.shadowRoot)!=null?i:this.attachShadow(this.constructor.shadowRootOptions);return p(e,this.constructor.elementStyles),e}render(){return u`
            <slot></slot>
        `}update(e){if((e.has("itemSize")||e.has("gap")||e.has("padding")||e.has("focusableSelector"))&&(this.updateComplete.then(()=>{this.gridController.update({elements:()=>[...this.querySelectorAll(this.focusableSelector)],itemSize:()=>this.itemSize,gap:()=>this.gap,padding:()=>this.padding||this.gap})}),this.layout=g({itemSize:{width:`${this.itemSize.width}px`,height:`${this.itemSize.height}px`},gap:this.gap,padding:this.padding||this.gap})),e.has("renderItem")){const i=this.renderItem;this.renderItem=(t,r)=>{const n=this.selected.includes(t);return i(t,r,n)}}this.isConnected&&(this.__gridPart=c(super.render(),this)),super.update(e)}connectedCallback(){var e;super.connectedCallback(),(e=this.__gridPart)==null||e.setConnected(!0),this.addEventListener("change",this.handleChange,{capture:!0})}disconnectedCallback(){var e;this.removeEventListener("change",this.handleChange,{capture:!0}),(e=this.__gridPart)==null||e.setConnected(!1),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=void 0,this.lastTargetForChange=void 0),super.disconnectedCallback()}}s([a({type:String})],Grid.prototype,"focusableSelector",2),s([a({type:String})],Grid.prototype,"gap",2),s([a({type:String})],Grid.prototype,"padding",2),s([a({type:Array})],Grid.prototype,"items",2),s([a({type:Object})],Grid.prototype,"itemSize",2),s([a({type:Array})],Grid.prototype,"selected",2);
//# sourceMappingURL=Grid.js.map
