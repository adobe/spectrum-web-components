<html><head></head><body><sp-tab-panel class="section" value="overview"> <div class="headerContainer spectrum-Typography"><h2 id="overview" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeL">Overview</h2> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeL" href="#overview"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Overview</span></sp-link><sp-divider size="l"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">The <code class="spectrum-Code">ColorController</code> is a comprehensive <sp-link href="https://lit.dev/docs/composition/controllers/">reactive controller</sp-link> for managing and validating color values in various color spaces, including RGB, HSL, HSV, and Hex. It provides robust methods to set, get, and validate colors, as well as convert between different color formats. This controller is designed to be used within web components or other reactive elements to handle color-related interactions efficiently.</p> <div class="headerContainer spectrum-Typography"><h3 id="features" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeM">Features</h3> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeM" href="#features"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Features</span></sp-link><sp-divider size="m"></sp-divider></div><ul class="spectrum-Body spectrum-Body--sizeM"> <li><strong>Color management</strong>: Manage color values in multiple formats, including RGB, HSL, HSV, and Hex</li> <li><strong>Validation</strong>: Validate color strings and ensure they conform to expected formats</li> <li><strong>Conversion</strong>: Convert colors between different color spaces for versatile applications</li> <li><strong>State management</strong>: Maintain current color state and save/restore previous color values</li> <li><strong>Format preservation</strong>: Automatically preserve the format of the original color input when returning values</li> </ul> <div class="headerContainer spectrum-Typography"><h3 id="properties" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeM">Properties</h3> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeM" href="#properties"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Properties</span></sp-link><sp-divider size="m"></sp-divider></div><ul class="spectrum-Body spectrum-Body--sizeM"> <li><strong><code class="spectrum-Code">color</code></strong>: Gets or sets the current color value. The color can be provided in various formats, including strings, objects, or instances of the <code class="spectrum-Code">Color</code> class.</li> <li><strong><code class="spectrum-Code">colorValue</code></strong>: Gets the color value in various formats based on the original color input.</li> <li><strong><code class="spectrum-Code">hue</code></strong>: Gets or sets the hue value of the current color.</li> </ul> <div class="headerContainer spectrum-Typography"><h3 id="methods" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeM">Methods</h3> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeM" href="#methods"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Methods</span></sp-link><sp-divider size="m"></sp-divider></div><ul class="spectrum-Body spectrum-Body--sizeM"> <li> <p class="spectrum-Body spectrum-Body--sizeM"><strong><code class="spectrum-Code">validateColorString(color: string): ColorValidationResult</code></strong>:<br> Validates a color string and returns the validation result, including the color space, coordinates, alpha value, and validity.</p> <p class="spectrum-Body spectrum-Body--sizeM"><strong>Returns:</strong> <code class="spectrum-Code">ColorValidationResult</code> object with:</p> <ul class="spectrum-Body spectrum-Body--sizeM"> <li><code class="spectrum-Code">spaceId</code> (string | null): The color space identifier ('srgb', 'hsl', or 'hsv')</li> <li><code class="spectrum-Code">coords</code> (number[]): Array of numeric values representing the color coordinates</li> <li><code class="spectrum-Code">alpha</code> (number): The alpha value of the color (0 to 1)</li> <li><code class="spectrum-Code">isValid</code> (boolean): Whether the color string is valid</li> </ul> </li> <li> <p class="spectrum-Body spectrum-Body--sizeM"><strong><code class="spectrum-Code">getColor(format: string | ColorSpace): ColorObject</code></strong>:<br> Converts the current color to the specified format. Throws an error if the format is not valid.</p> <p class="spectrum-Body spectrum-Body--sizeM"><strong>Returns:</strong> <code class="spectrum-Code">ColorObject</code> - The color object in the specified format</p> </li> <li> <p class="spectrum-Body spectrum-Body--sizeM"><strong><code class="spectrum-Code">getHslString(): string</code></strong>:<br> Returns the current color in HSL string format.</p> <p class="spectrum-Body spectrum-Body--sizeM"><strong>Returns:</strong> string - HSL representation of the current color</p> </li> <li> <p class="spectrum-Body spectrum-Body--sizeM"><strong><code class="spectrum-Code">savePreviousColor(): void</code></strong>:<br> Saves the current color as the previous color.</p> </li> <li> <p class="spectrum-Body spectrum-Body--sizeM"><strong><code class="spectrum-Code">restorePreviousColor(): void</code></strong>:<br> Restores the previous color.</p> </li> </ul> <div class="headerContainer spectrum-Typography"><h3 id="usage" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeM">Usage</h3> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeM" href="#usage"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Usage</span></sp-link><sp-divider size="m"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM"><sp-link href="https://www.npmjs.com/package/@spectrum-web-components/reactive-controllers"><img src="https://img.shields.io/npm/v/@spectrum-web-components/reactive-controllers?style=for-the-badge" alt="See it on NPM!"></sp-link> <sp-link href="https://bundlephobia.com/result?p=@spectrum-web-components/reactive-controllers"><img src="https://img.shields.io/bundlephobia/minzip/@spectrum-web-components/reactive-controllers?style=for-the-badge" alt="How big is this package in your project?"></sp-link></p> <code-example class="language-bash" preprocessed="preprocessed"><pre class="language-bash" slot="code"><span class="token function">yarn</span> <span class="token function">add</span> @spectrum-web-components/reactive-controllers</pre></code-example> <p class="spectrum-Body spectrum-Body--sizeM">Import the <code class="spectrum-Code">ColorController</code> via:</p> <code-example class="language-typescript" preprocessed="preprocessed"><pre class="language-typescript" slot="code"><span class="token keyword">import</span> <span class="token punctuation">{</span> ColorController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@spectrum-web-components/reactive-controllers/src/ColorController.js'</span><span class="token punctuation">;</span></pre></code-example> <div class="headerContainer spectrum-Typography"><h3 id="examples" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeM">Examples</h3> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeM" href="#examples"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Examples</span></sp-link><sp-divider size="m"></sp-divider></div><div class="headerContainer spectrum-Typography"><h4 id="basic-usage" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeS">Basic usage</h4> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeS" href="#basic-usage"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Basic usage</span></sp-link><sp-divider size="s"></sp-divider></div><code-example class="language-typescript" preprocessed="preprocessed"><pre class="language-typescript" slot="code"><span class="token keyword">import</span> <span class="token punctuation">{</span> LitElement<span class="token punctuation">,</span> html <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lit'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> property <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lit/decorators.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ColorController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@spectrum-web-components/reactive-controllers/src/ColorController.js'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ColorPickerElement</span> <span class="token keyword">extends</span> <span class="token class-name">LitElement</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * Gets the current color value from the color controller.
     */</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">property</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> String <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">get</span> <span class="token function">color</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ColorTypes <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorController<span class="token punctuation">.</span>colorValue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Sets the color for the color controller.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">set</span> <span class="token function">color</span><span class="token punctuation">(</span>color<span class="token operator">:</span> ColorTypes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>colorController<span class="token punctuation">.</span>color <span class="token operator">=</span> color<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Initialize the controller to manage colors in HSV color space</span>
    <span class="token keyword">private</span> colorController <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ColorController</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> manageAs<span class="token operator">:</span> <span class="token string">'hsv'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
            &lt;div
                style="background-color: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>color<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"
                role="img"
                aria-label="Color preview: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>color<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"
            &gt;
                Current color: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>color<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
            &lt;/div&gt;
        </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'color-picker-element'</span><span class="token punctuation">,</span> ColorPickerElement<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></code-example> <div class="headerContainer spectrum-Typography"><h4 id="constructor-initialization" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeS">Constructor initialization</h4> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeS" href="#constructor-initialization"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Constructor initialization</span></sp-link><sp-divider size="s"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">The color controller can also be initialized in the constructor:</p> <code-example class="language-typescript" preprocessed="preprocessed"><pre class="language-typescript" slot="code"><span class="token keyword">import</span> <span class="token punctuation">{</span> LitElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lit'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ColorController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@spectrum-web-components/reactive-controllers/src/ColorController.js'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ColorPickerElement</span> <span class="token keyword">extends</span> <span class="token class-name">LitElement</span> <span class="token punctuation">{</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">property</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> String <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">get</span> <span class="token function">color</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ColorTypes <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorController<span class="token punctuation">.</span>colorValue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">set</span> <span class="token function">color</span><span class="token punctuation">(</span>color<span class="token operator">:</span> ColorTypes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>colorController<span class="token punctuation">.</span>color <span class="token operator">=</span> color<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> colorController<span class="token operator">:</span> ColorController<span class="token punctuation">;</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>colorController <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ColorController</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> manageAs<span class="token operator">:</span> <span class="token string">'hsv'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></code-example> <div class="headerContainer spectrum-Typography"><h4 id="color-validation" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeS">Color validation</h4> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeS" href="#color-validation"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Color validation</span></sp-link><sp-divider size="s"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">Validate color strings before using them:</p> <code-example class="language-typescript" preprocessed="preprocessed"><pre class="language-typescript" slot="code"><span class="token keyword">import</span> <span class="token punctuation">{</span> ColorController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@spectrum-web-components/reactive-controllers/src/ColorController.js'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ColorInputElement</span> <span class="token keyword">extends</span> <span class="token class-name">LitElement</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> colorController <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ColorController</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">handleColorInput</span><span class="token punctuation">(</span>event<span class="token operator">:</span> InputEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> input <span class="token operator">=</span> event<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLInputElement<span class="token punctuation">;</span>
        <span class="token keyword">const</span> validation <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorController<span class="token punctuation">.</span><span class="token function">validateColorString</span><span class="token punctuation">(</span>
            input<span class="token punctuation">.</span>value
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>validation<span class="token punctuation">.</span>isValid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>colorController<span class="token punctuation">.</span>color <span class="token operator">=</span> input<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            <span class="token comment">// Announce successful color change for screen readers</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'aria-live'</span><span class="token punctuation">,</span> <span class="token string">'polite'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'aria-label'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Color changed to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>input<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// Provide error feedback</span>
            input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'aria-invalid'</span><span class="token punctuation">,</span> <span class="token string">'true'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'aria-describedby'</span><span class="token punctuation">,</span> <span class="token string">'color-error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
            &lt;label for="color-input"&gt;Choose a color&lt;/label&gt;
            &lt;input
                id="color-input"
                type="text"
                @input=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleColorInput<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                aria-describedby="color-help"
            /&gt;
            &lt;span id="color-help"&gt;
                Enter a color in hex, RGB, HSL, or HSV format
            &lt;/span&gt;
            &lt;span id="color-error" role="alert"&gt;&lt;/span&gt;
        </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></code-example> <div class="headerContainer spectrum-Typography"><h4 id="usage-with-color-components" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeS">Usage with color components</h4> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeS" href="#usage-with-color-components"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Usage with color components</span></sp-link><sp-divider size="s"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">Example of using <code class="spectrum-Code">ColorController</code> within a color picker that works with other Spectrum Web Components:</p> <code-example class="language-typescript" preprocessed="preprocessed"><pre class="language-typescript" slot="code"><span class="token keyword">import</span> <span class="token punctuation">{</span> LitElement<span class="token punctuation">,</span> html <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lit'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ColorController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@spectrum-web-components/reactive-controllers/src/ColorController.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'@spectrum-web-components/field-label/sp-field-label.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'@spectrum-web-components/help-text/sp-help-text.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'@spectrum-web-components/color-area/sp-color-area.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'@spectrum-web-components/color-slider/sp-color-slider.js'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">CompleteColorPicker</span> <span class="token keyword">extends</span> <span class="token class-name">LitElement</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> colorController <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ColorController</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> manageAs<span class="token operator">:</span> <span class="token string">'hsv'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token decorator"><span class="token at operator">@</span><span class="token function">property</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> String <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">get</span> <span class="token function">color</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ColorTypes <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorController<span class="token punctuation">.</span>colorValue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">set</span> <span class="token function">color</span><span class="token punctuation">(</span>color<span class="token operator">:</span> ColorTypes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> oldColor <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>color<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>colorController<span class="token punctuation">.</span>color <span class="token operator">=</span> color<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">requestUpdate</span><span class="token punctuation">(</span><span class="token string">'color'</span><span class="token punctuation">,</span> oldColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">handleColorChange</span><span class="token punctuation">(</span>event<span class="token operator">:</span> Event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> target<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
            &lt;div role="group" aria-labelledby="picker-label"&gt;
                &lt;sp-field-label id="picker-label" for="color-area"&gt;
                    Color picker
                &lt;/sp-field-label&gt;
                &lt;sp-help-text&gt;
                    Choose a color from the picker or enter a value manually
                &lt;/sp-help-text&gt;

                &lt;sp-color-area
                    id="color-area"
                    .color=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>color<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                    @change=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleColorChange<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                &gt;&lt;/sp-color-area&gt;

                &lt;sp-color-slider
                    .color=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>color<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                    @change=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleColorChange<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                    aria-label="Hue slider"
                &gt;&lt;/sp-color-slider&gt;
            &lt;/div&gt;
        </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></code-example> <div class="headerContainer spectrum-Typography"><h4 id="saving-and-restoring-colors" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeS">Saving and restoring colors</h4> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeS" href="#saving-and-restoring-colors"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Saving and restoring colors</span></sp-link><sp-divider size="s"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">Implement undo functionality using <code class="spectrum-Code">savePreviousColor</code> and <code class="spectrum-Code">restorePreviousColor</code>:</p> <code-example class="language-typescript" preprocessed="preprocessed"><pre class="language-typescript" slot="code"><span class="token keyword">import</span> <span class="token punctuation">{</span> LitElement<span class="token punctuation">,</span> html <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lit'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ColorController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@spectrum-web-components/reactive-controllers/src/ColorController.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'@spectrum-web-components/button/sp-button.js'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ColorPickerWithUndo</span> <span class="token keyword">extends</span> <span class="token class-name">LitElement</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> colorController <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ColorController</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> manageAs<span class="token operator">:</span> <span class="token string">'hsv'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token decorator"><span class="token at operator">@</span><span class="token function">property</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> String <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">get</span> <span class="token function">color</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ColorTypes <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colorController<span class="token punctuation">.</span>colorValue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">set</span> <span class="token function">color</span><span class="token punctuation">(</span>color<span class="token operator">:</span> ColorTypes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Save the current color before changing</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>colorController<span class="token punctuation">.</span><span class="token function">savePreviousColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>colorController<span class="token punctuation">.</span>color <span class="token operator">=</span> color<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">handleUndo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>colorController<span class="token punctuation">.</span><span class="token function">restorePreviousColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">requestUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Announce undo action for screen readers</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">CustomEvent</span><span class="token punctuation">(</span><span class="token string">'color-restored'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                detail<span class="token operator">:</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token punctuation">}</span><span class="token punctuation">,</span>
                bubbles<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                composed<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
            &lt;div&gt;
                &lt;input
                    type="color"
                    .value=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>color<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                    @change=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token punctuation">(</span>e<span class="token operator">:</span> Event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                        <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLInputElement<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                    aria-label="Color picker"
                /&gt;
                &lt;sp-button
                    @click=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleUndo<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                    aria-label="Undo color change"
                &gt;
                    Undo
                &lt;/sp-button&gt;
            &lt;/div&gt;
        </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></code-example> <div class="headerContainer spectrum-Typography"><h3 id="supported-color-formats" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeM">Supported color formats</h3> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeM" href="#supported-color-formats"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Supported color formats</span></sp-link><sp-divider size="m"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">The <code class="spectrum-Code">ColorController</code> supports a wide range of color formats for input and output:</p> <sp-table> <sp-table-head> <sp-table-head-cell>Format</sp-table-head-cell> <sp-table-head-cell>Example values</sp-table-head-cell> <sp-table-head-cell>Description</sp-table-head-cell> </sp-table-head> <sp-table-body> <sp-table-row> <sp-table-cell>Hex3</sp-table-cell> <sp-table-cell><code class="spectrum-Code">#f00</code>, <code class="spectrum-Code">#0a5</code></sp-table-cell> <sp-table-cell>3-digit hexadecimal</sp-table-cell> </sp-table-row> <sp-table-row> <sp-table-cell>Hex4</sp-table-cell> <sp-table-cell><code class="spectrum-Code">#f00f</code>, <code class="spectrum-Code">#0a58</code></sp-table-cell> <sp-table-cell>3-digit hexadecimal + alpha</sp-table-cell> </sp-table-row> <sp-table-row> <sp-table-cell>Hex6</sp-table-cell> <sp-table-cell><code class="spectrum-Code">#ff0000</code>, <code class="spectrum-Code">#00aa55</code></sp-table-cell> <sp-table-cell>6-digit hexadecimal</sp-table-cell> </sp-table-row> <sp-table-row> <sp-table-cell>Hex8</sp-table-cell> <sp-table-cell><code class="spectrum-Code">#ff0000ff</code>, <code class="spectrum-Code">#00aa5580</code></sp-table-cell> <sp-table-cell>6-digit hexadecimal + alpha</sp-table-cell> </sp-table-row> <sp-table-row> <sp-table-cell>RGB</sp-table-cell> <sp-table-cell><code class="spectrum-Code">rgb(255, 0, 0)</code>, <code class="spectrum-Code">rgb(0, 170, 85)</code></sp-table-cell> <sp-table-cell>Red, Green, Blue values (0-255)</sp-table-cell> </sp-table-row> <sp-table-row> <sp-table-cell>RGBA</sp-table-cell> <sp-table-cell><code class="spectrum-Code">rgba(255, 0, 0, 1)</code>, <code class="spectrum-Code">rgba(0, 170, 85, 0.5)</code></sp-table-cell> <sp-table-cell>RGB + Alpha channel (0-1)</sp-table-cell> </sp-table-row> <sp-table-row> <sp-table-cell>HSL</sp-table-cell> <sp-table-cell><code class="spectrum-Code">hsl(0, 100%, 50%)</code>, <code class="spectrum-Code">hsl(150, 100%, 33%)</code></sp-table-cell> <sp-table-cell>Hue (0-360°), Saturation, Lightness</sp-table-cell> </sp-table-row> <sp-table-row> <sp-table-cell>HSLA</sp-table-cell> <sp-table-cell><code class="spectrum-Code">hsla(0, 100%, 50%, 1)</code>, <code class="spectrum-Code">hsla(150, 100%, 33%, 0.5)</code></sp-table-cell> <sp-table-cell>HSL + Alpha channel (0-1)</sp-table-cell> </sp-table-row> <sp-table-row> <sp-table-cell>HSV</sp-table-cell> <sp-table-cell><code class="spectrum-Code">hsv(0, 100%, 100%)</code>, <code class="spectrum-Code">hsv(150, 100%, 67%)</code></sp-table-cell> <sp-table-cell>Hue (0-360°), Saturation, Value</sp-table-cell> </sp-table-row> <sp-table-row> <sp-table-cell>HSVA</sp-table-cell> <sp-table-cell><code class="spectrum-Code">hsva(0, 100%, 100%, 1)</code>, <code class="spectrum-Code">hsva(150, 100%, 67%, 0.5)</code></sp-table-cell> <sp-table-cell>HSV + Alpha channel (0-1)</sp-table-cell> </sp-table-row> <sp-table-row> <sp-table-cell>Named Colors</sp-table-cell> <sp-table-cell><code class="spectrum-Code">red</code>, <code class="spectrum-Code">rebeccapurple</code>, <code class="spectrum-Code">darkseagreen</code></sp-table-cell> <sp-table-cell>CSS color keywords (<sp-link href="https://developer.mozilla.org/en-US/docs/Web/CSS/named-color">full list</sp-link>)</sp-table-cell> </sp-table-row> </sp-table-body> </sp-table> <div class="headerContainer spectrum-Typography"><h3 id="accessibility" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeM">Accessibility</h3> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeM" href="#accessibility"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Accessibility</span></sp-link><sp-divider size="m"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">When implementing color pickers or other color-related UI with the <code class="spectrum-Code">ColorController</code>, consider these accessibility best practices:</p> <div class="headerContainer spectrum-Typography"><h4 id="color-perception" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeS">Color perception</h4> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeS" href="#color-perception"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Color perception</span></sp-link><sp-divider size="s"></sp-divider></div><ul class="spectrum-Body spectrum-Body--sizeM"> <li><strong>Never rely on color alone</strong> to convey information. Always provide alternative text descriptions or patterns.</li> <li><strong>Provide text alternatives</strong> for color values (e.g., "red", "dark blue", "#FF0000") that are announced by screen readers.</li> <li>Use <strong>ARIA labels</strong> (<code class="spectrum-Code">aria-label</code> or <code class="spectrum-Code">aria-labelledby</code>) to describe the purpose of color controls.</li> </ul> <div class="headerContainer spectrum-Typography"><h4 id="screen-reader-support" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeS">Screen reader support</h4> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeS" href="#screen-reader-support"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Screen reader support</span></sp-link><sp-divider size="s"></sp-divider></div><ul class="spectrum-Body spectrum-Body--sizeM"> <li>Announce color changes with <code class="spectrum-Code">aria-live</code> regions when colors update dynamically.</li> <li>Provide meaningful labels for all interactive color controls.</li> <li>Include instructions in <code class="spectrum-Code">aria-describedby</code> for how to use color inputs.</li> </ul> <div class="headerContainer spectrum-Typography"><h4 id="keyboard-accessibility" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeS">Keyboard accessibility</h4> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeS" href="#keyboard-accessibility"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Keyboard accessibility</span></sp-link><sp-divider size="s"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">When building color pickers with this controller:</p> <ul class="spectrum-Body spectrum-Body--sizeM"> <li>Ensure all color selection methods are keyboard accessible.</li> <li>Provide visible focus indicators for all interactive elements.</li> <li>Consider implementing keyboard shortcuts for common actions (e.g., arrow keys for fine-tuning).</li> </ul> <div class="headerContainer spectrum-Typography"><h4 id="error-handling" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeS">Error handling</h4> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeS" href="#error-handling"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Error handling</span></sp-link><sp-divider size="s"></sp-divider></div><ul class="spectrum-Body spectrum-Body--sizeM"> <li>Use <code class="spectrum-Code">aria-invalid</code> and <code class="spectrum-Code">aria-describedby</code> to communicate validation errors.</li> <li>Provide clear error messages when color values are invalid.</li> </ul> <div class="headerContainer spectrum-Typography"><h4 id="color-contrast" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeS">Color contrast</h4> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeS" href="#color-contrast"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Color contrast</span></sp-link><sp-divider size="s"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">When using colors selected via this controller for text or UI elements, ensure they meet <sp-link href="https://www.w3.org/WAI/WCAG21/Understanding/contrast-minimum.html">WCAG 2.1 Level AA contrast requirements</sp-link>:</p> <ul class="spectrum-Body spectrum-Body--sizeM"> <li><strong>Normal text</strong>: 4.5:1 contrast ratio</li> <li><strong>Large text</strong> (18pt+ or 14pt+ bold): 3:1 contrast ratio</li> <li><strong>UI components and graphics</strong>: 3:1 contrast ratio</li> </ul> <div class="headerContainer spectrum-Typography"><h3 id="related-components" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeM">Related components</h3> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeM" href="#related-components"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Related components</span></sp-link><sp-divider size="m"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">The <code class="spectrum-Code">ColorController</code> is used by these Spectrum Web Components:</p> <ul class="spectrum-Body spectrum-Body--sizeM"> <li><sp-link href="../../components/color-area/"><code class="spectrum-Code">&lt;sp-color-area&gt;</code></sp-link> - Two-dimensional color picker</li> <li><sp-link href="../../components/color-field/"><code class="spectrum-Code">&lt;sp-color-field&gt;</code></sp-link> - Text input for color values</li> <li><sp-link href="../../components/color-slider/"><code class="spectrum-Code">&lt;sp-color-slider&gt;</code></sp-link> - Slider for selecting color channel values</li> <li><sp-link href="../../components/color-wheel/"><code class="spectrum-Code">&lt;sp-color-wheel&gt;</code></sp-link> - Circular hue selector</li> <li><sp-link href="../../components/swatch/"><code class="spectrum-Code">&lt;sp-swatch&gt;</code></sp-link> - Color preview display</li> </ul> </sp-tab-panel></body></html>