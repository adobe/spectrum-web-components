import{_ as t}from"./swc.CmLYFWVC.js";import{i as e,x as i,B as s}from"./swc.DWYvVEd1.js";import{n as o}from"./swc.WWX4rCzN.js";import{d as n,a as r,v as a,b as h}from"./swc.CBpsOwvc.js";import{B as d,d as l,a as p}from"./swc.5zORiZ3L.js";import{i as c,S as g}from"./swc.CRBjbaNr.js";import{s as m}from"./swc.Byki1UKV.js";import{R as u}from"./swc.BuoeVPqT.js";import"./swc.C2nzd_6G.js";import"./swc.CedePp-f.js";import"./swc.B_r0cPOP.js";import"./swc.Cxa0JK8L.js";import"./swc.CA-i04Ei.js";import"./swc.DeJGzahI.js";import"./swc.Chxt1mTH.js";import"./swc.BEmPTaYY.js";import"./swc.CIw_Gjml.js";import"./swc.CxDHb17L.js";import"./swc.BjpW266Y.js";import"./swc.DZnb36D7.js";import"./swc.Dj_ig5vR.js";import"./swc.CXGe4OSw.js";import"./swc.CjPt0-_4.js";import"./swc.BW7sjKKb.js";import"./swc.BJvZxj2n.js";import"./swc.BF0WJ_I6.js";import"./swc.DrNXZKLt.js";class _ extends e{constructor(){super(...arguments),this.items=[],this.renderItem=n,this.keyFunction=r,this.layout={},this.scroller=!1}createRenderRoot(){return this}render(){const{items:t,renderItem:e,keyFunction:s,layout:o,scroller:n}=this;return i`${a({items:t,renderItem:e,keyFunction:s,layout:o,scroller:n})}`}element(t){return this[h]?.element(t)}get layoutComplete(){return this[h]?.layoutComplete}scrollToIndex(t,e="start"){this.element(t)?.scrollIntoView({block:e})}}function f(t){return"horizontal"===t?"row":"column"}t([o({attribute:!1})],_.prototype,"items",void 0),t([o()],_.prototype,"renderItem",void 0),t([o()],_.prototype,"keyFunction",void 0),t([o({attribute:!1})],_.prototype,"layout",void 0),t([o({reflect:!0,type:Boolean})],_.prototype,"scroller",void 0);class S extends d{constructor(){super(...arguments),this._itemSize={},this._gaps={},this._padding={}}_getDefaultConfig(){return Object.assign({},super._getDefaultConfig(),{itemSize:{width:"300px",height:"300px"},gap:"8px",padding:"match-gap"})}get _gap(){return this._gaps.row}get _idealSize(){return this._itemSize[l(this.direction)]}get _idealSize1(){return this._itemSize[l(this.direction)]}get _idealSize2(){return this._itemSize[p(this.direction)]}get _gap1(){return this._gaps[(t=this.direction,"horizontal"===t?"column":"row")];var t}get _gap2(){return this._gaps[f(this.direction)]}get _padding1(){const t=this._padding,[e,i]="horizontal"===this.direction?["left","right"]:["top","bottom"];return[t[e],t[i]]}get _padding2(){const t=this._padding,[e,i]="horizontal"===this.direction?["top","bottom"]:["left","right"];return[t[e],t[i]]}set itemSize(t){const e=this._itemSize;"string"==typeof t&&(t={width:t,height:t});const i=parseInt(t.width),s=parseInt(t.height);i!==e.width&&(e.width=i,this._triggerReflow()),s!==e.height&&(e.height=s,this._triggerReflow())}set gap(t){this._setGap(t)}_setGap(t){const e=t.split(" ").map(t=>function(t){return"auto"===t?1/0:parseInt(t)}(t)),i=this._gaps;e[0]!==i.row&&(i.row=e[0],this._triggerReflow()),void 0===e[1]?e[0]!==i.column&&(i.column=e[0],this._triggerReflow()):e[1]!==i.column&&(i.column=e[1],this._triggerReflow())}set padding(t){const e=this._padding,i=t.split(" ").map(t=>function(t){return"match-gap"===t?1/0:parseInt(t)}(t));1===i.length?(e.top=e.right=e.bottom=e.left=i[0],this._triggerReflow()):2===i.length?(e.top=e.bottom=i[0],e.right=e.left=i[1],this._triggerReflow()):3===i.length?(e.top=i[0],e.right=e.left=i[1],e.bottom=i[2],this._triggerReflow()):4===i.length&&(["top","right","bottom","left"].forEach((t,s)=>e[t]=i[s]),this._triggerReflow())}}class w extends S{constructor(){super(...arguments),this._metrics=null,this.flex=null,this.justify=null}_getDefaultConfig(){return Object.assign({},super._getDefaultConfig(),{flex:!1,justify:"start"})}set gap(t){super._setGap(t)}_updateLayout(){const t=this.justify,[e,i]=this._padding1,[s,o]=this._padding2;["_gap1","_gap2"].forEach(e=>{const i=this[e];if(i===1/0&&!["space-between","space-around","space-evenly"].includes(t))throw new Error("grid layout: gap can only be set to 'auto' when justify is set to 'space-between', 'space-around' or 'space-evenly'");if(i===1/0&&"_gap2"===e)throw new Error(`grid layout: ${f(this.direction)}-gap cannot be set to 'auto' when direction is set to ${this.direction}`)});const n=this.flex||["start","center","end"].includes(t),r={rolumns:-1,itemSize1:-1,itemSize2:-1,gap1:this._gap1===1/0?-1:this._gap1,gap2:n?this._gap2:0,padding1:{start:e===1/0?this._gap1:e,end:i===1/0?this._gap1:i},padding2:n?{start:s===1/0?this._gap2:s,end:o===1/0?this._gap2:o}:{start:0,end:0},positions:[]},a=this._viewDim2-r.padding2.start-r.padding2.end;if(a<=0)r.rolumns=0;else{const s=n?r.gap2:0;let o,h=0,d=0;if(a>=this._idealSize2&&(h=Math.floor((a-this._idealSize2)/(this._idealSize2+s))+1,d=h*this._idealSize2+(h-1)*s),this.flex){(a-d)/(this._idealSize2+s)>=.5&&(h+=1),r.rolumns=h,r.itemSize2=Math.round((a-s*(h-1))/h);switch(!0===this.flex?"area":this.flex.preserve){case"aspect-ratio":r.itemSize1=Math.round(this._idealSize1/this._idealSize2*r.itemSize2);break;case l(this.direction):r.itemSize1=Math.round(this._idealSize1);break;default:r.itemSize1=Math.round(this._idealSize1*this._idealSize2/r.itemSize2)}}else r.itemSize1=this._idealSize1,r.itemSize2=this._idealSize2,r.rolumns=h;if(n){const e=r.rolumns*r.itemSize2+(r.rolumns-1)*r.gap2;o=this.flex||"start"===t?r.padding2.start:"end"===t?this._viewDim2-r.padding2.end-e:Math.round(this._viewDim2/2-e/2)}else{const s=a-r.rolumns*r.itemSize2;"space-between"===t?(r.gap2=Math.round(s/(r.rolumns-1)),o=0):"space-around"===t?(r.gap2=Math.round(s/r.rolumns),o=Math.round(r.gap2/2)):(r.gap2=Math.round(s/(r.rolumns+1)),o=r.gap2),this._gap1===1/0&&(r.gap1=r.gap2,e===1/0&&(r.padding1.start=o),i===1/0&&(r.padding1.end=o))}for(let t=0;t<r.rolumns;t++)r.positions.push(o),o+=r.itemSize2+r.gap2}this._metrics=r}}class y extends w{get _delta(){return this._metrics.itemSize1+this._metrics.gap1}_getItemSize(t){return{[this._sizeDim]:this._metrics.itemSize1,[this._secondarySizeDim]:this._metrics.itemSize2}}_getActiveItems(){const t=this._metrics,{rolumns:e}=t;if(0===e)this._first=-1,this._last=-1,this._physicalMin=0,this._physicalMax=0;else{const{padding1:i}=t,s=Math.max(0,this._scrollPosition-this._overhang),o=Math.min(this._scrollSize,this._scrollPosition+this._viewDim1+this._overhang),n=Math.max(0,Math.floor((s-i.start)/this._delta)),r=Math.max(0,Math.ceil((o-i.start)/this._delta));this._first=n*e,this._last=Math.min(r*e-1,this.items.length-1),this._physicalMin=i.start+this._delta*n,this._physicalMax=i.start+this._delta*r}}_getItemPosition(t){const{rolumns:e,padding1:i,positions:s,itemSize1:o,itemSize2:n}=this._metrics;return{[this._positionDim]:i.start+Math.floor(t/e)*this._delta,[this._secondaryPositionDim]:s[t%e],[l(this.direction)]:o,[p(this.direction)]:n}}_updateScrollSize(){const{rolumns:t,gap1:e,padding1:i,itemSize1:s}=this._metrics;let o=1;if(t>0){const n=Math.ceil(this.items.length/t);o=i.start+n*s+(n-1)*e+i.end}this._scrollSize=o}}const z=c`
    :host{contain:strict;pointer-events:none;display:block;position:relative}::slotted(*){pointer-events:all}
`,v=t=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})};class b{constructor(t,{elements:e,itemSize:i,gap:s,padding:o}){this._first=0,this._last=0,this.handleFocusin=t=>{const e=()=>this.host.scrollToIndex(0),i=()=>{this.focus(),this.host.tabIndex=-1};t.target===this.host&&(this._first>0?v(()=>{e(),v(i)}):v(i))},this.handleFocusout=t=>{(!t.relatedTarget||!this.host.contains(t.relatedTarget))&&(this.host.tabIndex=0)},this.handleRangeChanged=t=>{this.rovingTabindexController.clearElementCache(t.first)},this.handleVisibleChanged=t=>{this._first=t.first,this._last=t.last},this.host=t,this.host.addController(this),this.applyLayout(i,s,o),this.resizeController=new m(this.host,{callback:t=>{t.forEach(t=>{this.measureDirectionLength(t.contentRect)})}}),this.rovingTabindexController=new u(this.host,{direction:"grid",elements:e,focusInIndex:()=>this.host.getRootNode().activeElement===this.host?0:-1})}get itemSize(){return this._itemSize()}_itemSize(){return{width:100,height:100}}get gap(){return this._gap()}_gap(){}get padding(){return this._padding()}_padding(){}focus(t){this.rovingTabindexController.focus(t)}applyLayout(t,e,i){"object"==typeof t?this._itemSize=()=>t:"function"==typeof t&&void 0!==t()&&(this._itemSize=t),"string"==typeof e?this._gap=()=>e:"function"==typeof e&&(this._gap=e),"string"==typeof i?this._padding=()=>i:"function"==typeof i&&(this._padding=i)}update({elements:t,itemSize:e,gap:i,padding:s}){this.rovingTabindexController.update({elements:t}),this.applyLayout(e,i,s);const o=this.host.getBoundingClientRect();this.measureDirectionLength(o)}measureDirectionLength(t){const e=this.gap?parseFloat(this.gap):0,i=this.padding?parseFloat(this.padding):0,s=t.width-2*i,o=Math.floor((s-this.itemSize.width)/(e+this.itemSize.width))+1;this.rovingTabindexController.directionLength=Math.floor(o)}hostConnected(){this.host.addEventListener("rangeChanged",this.handleRangeChanged),this.host.addEventListener("visibilityChanged",this.handleVisibleChanged),this.host.addEventListener("focusin",this.handleFocusin),this.host.addEventListener("focusout",this.handleFocusout),this.host.tabIndex=0,this.host.style.setProperty("outline","none","important")}hostDisconnected(){this.host.removeEventListener("rangeChanged",this.handleRangeChanged),this.host.removeEventListener("visibilityChanged",this.handleVisibleChanged),this.host.removeEventListener("focusin",this.handleFocusin),this.host.removeEventListener("focusout",this.handleFocusout)}}var C=Object.defineProperty,j=(t,e,i,s)=>{for(var o,n=void 0,r=t.length-1;r>=0;r--)(o=t[r])&&(n=o(e,i,n)||n);return n&&C(e,i,n),n};class x extends _{constructor(){super(...arguments),this.__gridPart=void 0,this.gap="0",this.items=[],this.itemSize={width:200,height:200},this.selected=[],this.gridController=new b(this,{elements:()=>[],itemSize:()=>this.itemSize,gap:()=>this.gap,padding:()=>this.padding||this.gap})}static get styles(){return[z]}handleChange(t){const e=t.target;if(this.lastTargetForChange===e)return;this.lastTargetForChange=e,this.animationFrameId=requestAnimationFrame(()=>{this.lastTargetForChange=void 0});const i=this.items[parseFloat(e.getAttribute("key")||"")],s=[...this.selected];if(s.includes(i)){const t=s.indexOf(i);t>-1&&s.splice(t,1)}else s.push(i);this.selected=s}createRenderRoot(){var t;const e=null!=(t=this.shadowRoot)?t:this.attachShadow(this.constructor.shadowRootOptions);return g(e,this.constructor.elementStyles),e}render(){return i`
            <slot></slot>
        `}update(t){if((t.has("itemSize")||t.has("gap")||t.has("padding")||t.has("focusableSelector"))&&(this.updateComplete.then(()=>{this.gridController.update({elements:()=>[...this.querySelectorAll(this.focusableSelector)],itemSize:()=>this.itemSize,gap:()=>this.gap,padding:()=>this.padding||this.gap})}),this.layout=(e={itemSize:{width:`${this.itemSize.width}px`,height:`${this.itemSize.height}px`},gap:this.gap,padding:this.padding||this.gap},Object.assign({type:y},e))),t.has("renderItem")){const t=this.renderItem;this.renderItem=(e,i)=>{const s=this.selected.includes(e);return t(e,i,s)}}var e;this.isConnected&&(this.__gridPart=s(super.render(),this)),super.update(t)}connectedCallback(){var t;super.connectedCallback(),null==(t=this.__gridPart)||t.setConnected(!0),this.addEventListener("change",this.handleChange,{capture:!0})}disconnectedCallback(){var t;this.removeEventListener("change",this.handleChange,{capture:!0}),null==(t=this.__gridPart)||t.setConnected(!1),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=void 0,this.lastTargetForChange=void 0),super.disconnectedCallback()}}j([o({type:String})],x.prototype,"focusableSelector"),j([o({type:String})],x.prototype,"gap"),j([o({type:String})],x.prototype,"padding"),j([o({type:Array})],x.prototype,"items"),j([o({type:Object})],x.prototype,"itemSize"),j([o({type:Array})],x.prototype,"selected"),customElements.define("sp-grid",x);
//# sourceMappingURL=swc.DEk5IKiV.js.map
